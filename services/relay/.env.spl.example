# Cloak Relay Service - SPL Token Configuration Example
#
# This is an example configuration for running the Cloak relay with SPL token support.
# Copy this to .env and customize for your deployment.

# =============================================================================
# NETWORK CONFIGURATION
# =============================================================================

# Solana RPC endpoint
SOLANA_RPC_URL=https://api.devnet.solana.com

# Solana WebSocket endpoint
SOLANA_WS_URL=wss://api.devnet.solana.com

# Commitment level: processed, confirmed, finalized
SOLANA_COMMITMENT=confirmed

# =============================================================================
# SPL TOKEN CONFIGURATION
# =============================================================================

# Token mint address
# - Leave empty for native SOL: MINT_ADDRESS=
# - Set to mint pubkey for SPL tokens
#
# Common devnet mints:
# - USDC: EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v
# - USDT: Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB
#
# For custom tokens, use your own mint address
MINT_ADDRESS=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v

# =============================================================================
# SHIELD POOL PROGRAM
# =============================================================================

# Cloak shield-pool program ID (deployed on Solana)
CLOAK_PROGRAM_ID=your_program_id_here

# Optional: Pre-computed PDA addresses (leave empty to derive automatically)
# These are derived from program ID + mint, so they change per token
# CLOAK_POOL_ADDRESS=
# CLOAK_TREASURY_ADDRESS=
# ROOTS_RING_ADDRESS=
# CLOAK_NULLIFIER_SHARD_ADDRESS=

# =============================================================================
# TRANSACTION SETTINGS
# =============================================================================

# Priority fee in micro-lamports per compute unit
# Higher values = faster transaction confirmation
SOLANA_PRIORITY_MICROLAMPORTS=10000

# Jito tip amount in lamports (if using Jito)
SOLANA_JITO_TIP_LAMPORTS=100000

# Transaction retry settings
SOLANA_MAX_RETRIES=5
SOLANA_RETRY_DELAY_MS=2000

# =============================================================================
# JUPITER DEX INTEGRATION (Optional)
# =============================================================================

# Enable Jupiter swap aggregator integration
JUPITER_ENABLED=true

# Jupiter API endpoint (v6)
JUPITER_API_URL=https://quote-api.jup.ag/v6

# Slippage tolerance in basis points (50 = 0.5%, 100 = 1%)
JUPITER_SLIPPAGE_BPS=50

# Optional: Force DNS resolution for Jupiter API host when container DNS is blocked
# Set this to an IPv4 address for quote-api.jup.ag (TLS still uses the hostname via SNI)
# Example (replace with a current IP):
# JUPITER_DNS_OVERRIDE_IP=104.18.28.124

# Optional: Override the output mint used for Jupiter quoting
# Useful when running on devnet but needing mainnet canonical mints for quotes (e.g., USDC)
# Example: EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v (mainnet USDC)
# JUPITER_OUTPUT_MINT_OVERRIDE=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v

# Optional: Prefer stable routes (recommended for dev/test)
# When true, adds restrictIntermediateTokens=true to quotes
JUPITER_RESTRICT_INTERMEDIATE_TOKENS=true

# =============================================================================
# PROOF-OF-WORK (PoW) CONFIGURATION
# =============================================================================

# Scramble Registry program ID (optional - for PoW-enabled withdrawals)
# Leave empty to disable PoW
SCRAMBLE_REGISTRY_PROGRAM_ID=

# =============================================================================
# ADMIN CONFIGURATION
# =============================================================================

# Admin keypair for signing transactions (JSON array format)
# This keypair is used to:
# - Submit withdraw transactions
# - Pay for transaction fees
# - Sign as fee payer
#
# Generate: solana-keygen new -o keypair.json --no-bip39-passphrase
# Then: cat keypair.json
ADMIN_KEYPAIR=[66,197,...]

# OR use file path (alternative to ADMIN_KEYPAIR)
# ADMIN_KEYPAIR_PATH=/path/to/keypair.json

# =============================================================================
# DATABASE CONFIGURATION
# =============================================================================

# PostgreSQL connection string
DATABASE_URL=postgres://cloak:password@localhost:5432/cloak_relay

# Database connection pool settings
DB_MAX_CONNECTIONS=20

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================

# HTTP server settings
RELAY_PORT=3002
RELAY_HOST=0.0.0.0
RELAY_REQUEST_TIMEOUT_SECONDS=30

# =============================================================================
# METRICS & MONITORING
# =============================================================================

# Enable Prometheus metrics endpoint
RELAY_METRICS_ENABLED=true
RELAY_METRICS_PORT=9090
RELAY_METRICS_ROUTE=/metrics

# =============================================================================
# EXAMPLE CONFIGURATIONS
# =============================================================================

## Example 1: Native SOL Pool (Default)
# MINT_ADDRESS=
# CLOAK_PROGRAM_ID=c1oak...
# JUPITER_ENABLED=false

## Example 2: USDC Pool on Devnet
# MINT_ADDRESS=EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v
# SOLANA_RPC_URL=https://api.devnet.solana.com
# JUPITER_ENABLED=true
# JUPITER_SLIPPAGE_BPS=100  # Higher slippage for devnet

## Example 3: Custom Token on Mainnet
# MINT_ADDRESS=YourCustomMint111111111111111111111111111
# SOLANA_RPC_URL=https://api.mainnet-beta.solana.com
# JUPITER_ENABLED=true
# JUPITER_SLIPPAGE_BPS=50
# SOLANA_PRIORITY_MICROLAMPORTS=50000  # Higher priority for mainnet
